<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Synthra | Pro Swap</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
    <style>
        body { background: #0d1117; color: #c9d1d9; font-family: sans-serif; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .card { background: #161b22; padding: 25px; border-radius: 20px; width: 340px; border: 1px solid #30363d; }
        .input-box { background: #0d1117; padding: 15px; border-radius: 12px; margin: 15px 0; border: 1px solid #30363d; }
        input, select { background: transparent; border: none; color: white; font-size: 18px; width: 100%; outline: none; margin-top: 5px; }
        button { width: 100%; padding: 15px; border-radius: 12px; border: none; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .btn-green { background: #238636; color: white; }
        .btn-blue { background: #1f6feb; color: white; }
        #status { font-size: 11px; color: #8b949e; margin-top: 15px; background: #010409; padding: 10px; border-radius: 6px; }
    </style>
</head>
<body>

<div class="card">
    <h3 style="text-align:center;">Synthra Swap</h3>
    <button class="btn-green" id="connectBtn" onclick="connect()">Connect Wallet</button>
    
    <div class="input-box">
        <div id="balance" style="font-size:12px; color:#3fb950; text-align:right;">USDC: 0.00</div>
        <label style="font-size:10px; color:#8b949e;">Sell Amount (USDC)</label>
        <input type="number" id="amtIn" placeholder="0.0">
    </div>

    <div class="input-box">
        <label style="font-size:10px; color:#8b949e;">Swap Into:</label>
        <select id="targetToken">
            <option value="ETH">ETH (Native Gas)</option>
            <option value="USYC">USYC (Circle Fund)</option>
            <option value="ARC">ARC Governance</option>
        </select>
    </div>

    <button class="btn-blue" onclick="startSwap()">Execute Swap</button>
    <div id="status">Ready</div>
</div>

<script>
    const swapContract = "0xF94430860CA78B4BF9cC28f24D3c4B38C87d9A0f";
    let provider, signer, address;

    async function connect() {
        if (!window.ethereum) return alert("Open in MetaMask!");
        const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
        address = accounts[0];
        provider = new ethers.providers.Web3Provider(window.ethereum);
        signer = provider.getSigner();
        document.getElementById('connectBtn').innerText = "Linked: " + address.substring(0,6);
        
        // Fetching Native USDC Balance
        const bal = await provider.getBalance(address);
        document.getElementById('balance').innerText = "USDC: " + ethers.utils.formatEther(bal);
        document.getElementById('status').innerText = "Wallet Connected!";
    }

    async function startSwap() {
        if(!signer) return alert("Connect first");
        const amount = document.getElementById('amtIn').value;
        const target = document.getElementById('targetToken').value;
        if(!amount) return alert("Enter amount");

        try {
            document.getElementById('status').innerText = `Swapping USDC for ${target}...`;
            const contract = new ethers.Contract(swapContract, [
                "function swapToken1ForToken2(uint256) external"
            ], signer);

            const val = ethers.utils.parseEther(amount);
            const tx = await contract.swapToken1ForToken2(val, { gasLimit: 500000 });

            document.getElementById('status').innerText = "Waiting for confirm...";
            await tx.wait();
            document.getElementById('status').innerText = `Success! Swapped to ${target} ðŸŽ‰`;
            connect(); 
        } catch (e) {
            document.getElementById('status').innerText = "Error: Transaction Reverted (Low Liquidity or Gas)";
        }
    }
</script>
</body>
</html>
